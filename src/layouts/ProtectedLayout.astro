---
import Layout from './Layout.astro';

interface Props {
  requireAuth?: boolean;
  requireAdmin?: boolean;
}

const { requireAuth = false, requireAdmin = false } = Astro.props;
---

<Layout>
  <div id="protected-content" style="display: none;">
    <slot />
  </div>

  <script>
    const userRole = localStorage.getItem('user_role');
    const currentPath = window.location.pathname;

    if (currentPath.startsWith('/admin')) {
      if (userRole !== 'admin') {
        window.location.href = '/login?redirect=' + encodeURIComponent(currentPath);
      } else {
        // Es admin â†’ mostrar contenido
        const el = document.getElementById('protected-content');
        if (el) el.style.display = '';
      }
    } else {
      const el = document.getElementById('protected-content');
      if (el) el.style.display = '';
    }
  </script>
</Layout>
