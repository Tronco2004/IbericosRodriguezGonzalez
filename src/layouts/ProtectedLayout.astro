---
import Layout from './Layout.astro';

interface Props {
  requireAuth?: boolean;
  requireAdmin?: boolean;
}

const { requireAuth = false, requireAdmin = false } = Astro.props;
---

<Layout>
  <script>
    const userRole = localStorage.getItem('user_role');
    const currentPath = window.location.pathname;

    console.log('Validando acceso:');
    console.log('  Path:', currentPath);
    console.log('  Rol desde localStorage:', userRole);

    // Si es una ruta admin y no tiene rol admin, redirigir
    if (currentPath.startsWith('/admin')) {
      if (userRole !== 'admin') {
        console.log('⛔ No es admin, redirigiendo');
        window.location.href = '/sin-acceso';
      } else {
        console.log('✅ Es admin, permitiendo acceso');
      }
    }
  </script>

  <slot />
</Layout>
